{{- $name := promptStringOnce . "name" "Your Name" "Julio Lira" -}}
{{- $machine_type := promptStringOnce . "machine_type" "Machine type (personal/work/hybrid)" "hybrid" -}}
{{- $os := promptStringOnce . "os" "Operating System" "linux" -}}
{{- $editor := promptStringOnce . "editor" "Default Editor" "code" -}}

{{- $personal_email := "" -}}
{{- if or (eq $machine_type "personal") (eq $machine_type "hybrid") -}}
{{-   $personal_email = promptStringOnce . "personal_email" "Personal Email" "" -}}
{{- end -}}

{{- $work_email := "" -}}
{{- if or (eq $machine_type "work") (eq $machine_type "hybrid") -}}
{{-   $work_email = promptStringOnce . "work_email" "Work Email" "" -}}
{{- end -}}

{{- $recipient := promptStringOnce . "recipient" "Age Public Key (age1...)" -}}

encryption = "age"

[data]
    name = {{ $name | quote }}
    machine_type = {{ $machine_type | quote }}
    os = {{ $os | quote }}
    editor = {{ $editor | quote }}
    personal_email = {{ $personal_email | quote }}
    work_email = {{ $work_email | quote }}

[edit]
    command = {{ $editor | quote }}
    args = ["--wait"]

[diff]
    command = {{ $editor | quote }}
    args = ["--wait", "--diff"]

[merge]
    command = "bash"
    args = [
        "-c",
        "cp {{ "{{" }} .Target {{ "}}" }} {{ "{{" }} .Target {{ "}}" }}.base && {{ $editor }} --new-window --wait --merge {{ "{{" }} .Destination {{ "}}" }} {{ "{{" }} .Target {{ "}}" }} {{ "{{" }} .Target {{ "}}" }}.base {{ "{{" }} .Source {{ "}}" }}",
    ]

[bitwarden]
    command = "bw"
    unlock = "auto"

[age]
    identity = "~/.config/chezmoi/key.txt"
    recipient = {{ $recipient | quote }}
